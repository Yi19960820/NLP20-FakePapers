cancer is one of the most common and deadly malignant cancers. Like other cancers, the best solution for lung cancer is early diagnosis and timely treatment. Therefore regular examinations are necessary. The volumetric thoracic Computed Tomography (CT) is a common imaging tool for lung cancer diagnosis _cite_ . It visualizes all tissues according to their absorption of X-ray. The lesion in the lung is called pulmonary nodules. A nodule usually has the same absorption level as the normal tissues, but has a distinctive shape: the bronchus and vessels are continuous pipe systems, thick at the root and thin at the branch, and nodules are usually spherical and isolated. It usually takes an experienced doctor around N minutes to perform a thorough check for a patient, because some nodules are small and hard to be found. Moreover, there are many subtypes of nodules, and the cancer probabilities of different subtypes are different. Doctors can evaluate the malignancy of nodules based on their morphology, but the accuracy highly depends on doctors' experience, and different doctors may give different predictions _cite_ . Computer-aided diagnosis (CAD) is suitable for this task because computer vision models can quickly scan everywhere with equal quality and they are not affected by fatigue and emotions. Recent advancement of deep learning has enabled computer vision models to help the doctors to diagnose various problems and in some cases the models have exhibited competitive performance to doctors _cite_ . Automatic lung cancer diagnosing has several difficulties compared with general computer vision problems. First, nodule detection is a ND object detection problem which is harder than ND object detection. Direct generalization of ND object detection methods to ND cases faces technical difficulty due to the limited GPU memory. Therefore some methods use ND region proposal networks (RPN) to extract proposals in individual ND images then combine them to generate ND proposals _cite_ . More importantly, labeling ND data is usually much harder than labeling ND data, which may make deep learning models fail due to over-fitting. Second, the shape of the nodules is diverse (Fig. _ref_), and the difference between nodules and normal tissues is vague. In consequence, even experienced doctors cannot reach consensuses in some cases _cite_ . Third, the relationship between nodule and cancer is complicated. The existence of nodule does not definitely indicate lung cancer. For patients with multiple nodules, all nodules should be considered to infer the cancer probability. In other words, unlike the classical detection task and the classical classification task, in this task, a label corresponds to several objects. This is a multiple instance learning (MIL) _cite_ problem, which is a hard problem in computer vision. To tackle these difficulties, we take the following strategies. We built a ND RPN _cite_ to directly predict the bounding boxes for nodules. The ND convolutional neural network (CNN) structure enables the network to capture complex features. To deal with the GPU memory problem, a patch-based training and testing strategy is used. The model is trained end-to-end to achieve efficient optimization. Extensive data augmentation is used to combat over-fitting. The threshold for the detector is set low such that all suspicious nodules are included. Then the top five suspicious nodules are selected as input to the classifier. A leaky noisy-or model _cite_ is introduced in the classifier to combine the scores of top five nodules. The noisy-or model is a local causal probability model commonly used in probability graph models _cite_ . It assumes that an event can be caused by different factors, and the happening of any one of these factors can lead to the happening of the event with independent probability. One modified version of the model is called leaky noisy-or model _cite_, which assumes that there is a leakage probability for the event even none of the factors happens. The leaky noisy-or model is suitable for this task. First, when multiple nodules are present in a case, all nodules contribute to the final prediction. Second, a highly suspicious nodule would explain away the cancer case, which is desirable. Third, when no nodule can explain a cancer case, cancer can be attributed to a leakage probability. The classification network is also a ND neural network. To prevent over-fitting, we let the classification network share the backbone of the detection network (the parameters of the backbones of the two networks are tied) and train the two networks alternately. Extensive data augmentation are also used. Our contributions in this work are summarized as follows: We validated the proposed method on the Data Science Bowl N and won the first place among N teams. The rest of the paper is organized as follows. Section _ref_ presents some closely related works. The pipeline of the proposed method is detailed in subsequent sections. It consists of three steps: (N) preprocessing (Section _ref_): segment the lung out from other tissues; (N) detection (Section _ref_): find all suspicious nodules in the lung; (N) classification (Section _ref_): score all nodules and combine their cancer probabilities to get the overall cancer probability of the patient. The first step is accomplished by classical image preprocessing techniques and the other two steps by neural networks. The results are presented in Sections _ref_ . Section _ref_ concludes the paper with some discussions.