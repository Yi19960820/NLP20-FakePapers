Under severe hazy conditions, floating particles in the atmosphere such as dusk and smoke greatly absorb and scatter the light, resulting in degradations in the image quality. These degradations in turn may affect the performance of many computer vision systems such as classification and detection. To overcome the degradations caused by haze, image and video-based haze removal algorithms have been proposed in the literature _cite_ . The image degradation (atmospheric scattering model) due to the presence of haze is mathematically formulated as where _inline_eq_ is the observed hazy image, _inline_eq_ is the true scene radiance, _inline_eq_ is the global atmospheric light, indicating the intensity of the ambient light, _inline_eq_ is the transmission map and _inline_eq_ is the pixel location. Transmission map is the distance-dependent factor that affects the fraction of light that reaches the camera sensor. When the atmospheric light _inline_eq_ is homogeneous, the transmission map can be expressed as _inline_eq_, where _inline_eq_ represents attenuation coefficient of the atmosphere and _inline_eq_ is the scene depth. In single image dehazing, given _inline_eq_, the goal is to estimate _inline_eq_ . It can be observed from Eq.~ _ref_ that there exists two important aspects in the dehazing process: and . Apart from several works that focus on estimating the atmospheric light _cite_, most of the other algorithms concentrate more on the accurate estimation of the transmission map and they leverage empirical rule in estimating the atmospheric light _cite_ . This is mainly due to the common belief that good estimation of transmission map will lead to better dehazing. These methods can be broadly divided into two main groups: prior-based methods and learning-based methods. Prior-based methods often leverage different priors in characterizing the transmission map such as dark-channel prior _cite_, contrast color-lines _cite_ and haze-line prior _cite_, while learning-based methods, such as those based on convolutional neural networks (CNNs), attempt to learn the transmission map directly from the training data _cite_ . Once the transmission map and the atmospheric light are estimated, the dehazed image can be recovered as follows Though tremendous improvements have been made by the learning-based methods, several factors hinder the performance of these methods and the results are far from optimal. This is mainly because: Most recently, a method was proposed in _cite_ to jointly optimize the whole dehazing network. This was achieved by leveraging a linear transformation to embed both the transmission map and the atmospheric light into one variable and then learning a light-weight CNN to recover the clean image. In this paper, we take a different approach in addressing the end-to-end learning for image dehazing. In particular, we propose a new image dehazing architecture, called Densely Connected Pyramid Dehazing Network (DCPDN), that can be jointly optimized to estimate transmission map, atmospheric light and also image dehazing simultaneously by following the image degradation model Eq.~ _ref_ (see Fig.~ _ref_) . In other words, the end-to-end learning is achieved by embedding Eq.~ _ref_ directly into the network via the math operation modules provided by the deep learning framework. However, training such a complex network (with three different tasks) is very challenging. To ease the training process and accelerate the network convergence, we leverage a stage-wise learning technique in which we first progressively optimize each part of the network and then jointly optimize the entire network. To make sure that the estimated transmission map preserves sharp edges and avoids halo artifacts when dehazing, a new edge-preserving loss function is proposed in this paper based on the observation that gradient operators and first several layers of a CNN structure can function as edge extractors. Furthermore, a densely connected encoder-decoder network with multi-level pooling modules is proposed to leverage features from different levels for estimating the transmission map. To exploit the structural relationship between the transmission map and the dehazed image, a joint discriminator-based generative adversarial network (GAN) is proposed. The joint discriminator distinguishes whether a pair of estimated transmission map and dehazed image is a real or fake pair. To guarantee that the atmospheric light can also be optimized within the whole structure, a U-net _cite_ is adopted to estimate the homogeneous atmospheric light map. Shown in Fig.~ _ref_ is a sample dehazed image using the proposed method. This paper makes the following contributions: